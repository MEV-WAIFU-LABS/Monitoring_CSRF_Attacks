<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>README - RDoc Documentation</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body class="file">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="./Gemfile.html">Gemfile</a>
  
    <li class="file"><a href="./README_rdoc.html">README</a>
  
    <li class="file"><a href="./lib/log_parser/strategies/sql/README_strategies.html">README_strategies</a>
  
    <li class="file"><a href="./logs/log.html">log</a>
  
    <li class="file"><a href="./logs/log_simple.html">log_simple</a>
  
    <li class="file"><a href="./logs/log_tests.html">log_tests</a>
  
    <li class="file"><a href="./logs/white_list.html">white_list</a>
  
    <li class="file"><a href="./logs/white_list2.html">white_list2</a>
  
    <li class="file"><a href="./spec/fixtures/log.html">log</a>
  
    <li class="file"><a href="./spec/fixtures/log_simple.html">log_simple</a>
  
    <li class="file"><a href="./spec/fixtures/log_tests.html">log_tests</a>
  
    <li class="file"><a href="./spec/fixtures/white_list.html">white_list</a>
  
    <li class="file"><a href="./spec/fixtures/white_list2.html">white_list2</a>
  
    <li class="file"><a href="./white_list.html">white_list</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./LogParser.html">LogParser</a>
  
    <li><a href="./LogParser/Log.html">LogParser::Log</a>
  
    <li><a href="./LogParser/LogEntry.html">LogParser::LogEntry</a>
  
    <li><a href="./LogParser/SqlInfo.html">LogParser::SqlInfo</a>
  
    <li><a href="./LogParser/Strategies.html">LogParser::Strategies</a>
  
    <li><a href="./LogParser/Strategies/Sql.html">LogParser::Strategies::Sql</a>
  
    <li><a href="./LogParser/Strategies/Sql/Base.html">LogParser::Strategies::Sql::Base</a>
  
    <li><a href="./LogParser/Strategies/Sql/Ragel.html">LogParser::Strategies::Sql::Ragel</a>
  
    <li><a href="./LogParser/Strategies/Sql/Regexp.html">LogParser::Strategies::Sql::Regexp</a>
  
    <li><a href="./LogParser/WhiteList.html">LogParser::WhiteList</a>
  
    <li><a href="./Object.html">Object</a>
  
    <li><a href="./Runtime.html">Runtime</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation" class="description">
  
<h6 id="label-"></h6>

<h1 id="label-Monitoring+Cross-site+Request+Forgery+Attacks+%28MonCSRF%29">Monitoring Cross-site Request Forgery Attacks (MonCSRF)</h1>

<pre>Stony Brook University, January/2012.</pre>

<h6 id="label-"></h6>

<h2 id="label-Introduction">Introduction</h2>

<p>MonCSRF is designed to detect requests in a web server that may result on
Cross-site Request Forgery (CSRF) attacks [1] [2] [3] [4] [5].</p>

<p>MonCSRF parses a given log file derived from a web server with DIVA [6] and
verifies whether (and how) the requests in this file had the state of the
system changed (named potential unsafe requests).</p>

<p>MonCSRF is written in Ruby 1.9.2 and Ragel [<a href="http://8">7]</a>.</p>

<h2 id="label-Strategies">Strategies</h2>

<p>MonCSRF contains two different strategies for parsing a log file from DIVA.</p>

<h3 id="label-Parsing+by+Regular+Expressions+%28REGEXP%29">Parsing by Regular Expressions (REGEXP)</h3>

<p>The class representing this strategy is located at:</p>

<p>/lib/log_parser/strategies/sql/regexp.rb</p>

<p>The default running does not use this strategy.</p>

<h3 id="label-Parsing+into+an+Abstract+Syntact+Tree+%28AST%29">Parsing into an Abstract Syntact Tree (AST)</h3>

<p>The class representing this strategy is located at:</p>

<p>/lib/log_parser/strategies/sql/ragel.rl</p>

<p>One can generates the .rb file by:</p>

<p>$ ragel -R ragel.rl</p>

<p>Ragel is a state machine compiler and parse generator.</p>

<h2 id="label-Whitelisting">Whitelisting</h2>

<p>Every time one runs MonCSRF, every the potential unsafe requests will be
compared to a whitelist. In the case which the program finds a previous
similar whitelisted request (i.e., with same syntactic structure), the new
request is automatically marked as safe. If the new request is not in the
whitelist, the program will generate an alert and ask about the safety of
it.</p>

<p>The whitelist file can be inspected at:</p>

<p>/white_list</p>

<h2 id="label-Tree+Struture+of+the+Files">Tree Struture of the Files</h2>

<p>├── bin</p>

<p>│   └── parser.rb</p>

<p>├── lib</p>

<p>│   ├── log_parser</p>

<p>│   │   ├── log_entry.rb</p>

<p>│   │   ├── log.rb</p>

<p>│   │   ├── sql_info.rb</p>

<p>│   │   ├── strategies</p>

<p>│   │   │   └── sql</p>

<p>│   │   │       ├── base.rb</p>

<p>│   │   │       ├── ragel.dot</p>

<p>│   │   │       ├── ragel.rb</p>

<p>│   │   │       ├── ragel.rl</p>

<p>│   │   │       ├── <a
href="lib/log_parser/strategies/sql/README_strategies.html">README_strategies</a></p>

<p>│   │   │       └── regexp.rb</p>

<p>│   │   └── white_list.rb</p>

<p>│   ├── log_parser.rb</p>

<p>│   └── runtime.rb</p>

<h2 id="label-Testings+%28For+Developers%29">Testings (For Developers)</h2>

<p>MonCSRF was written using testings:</p>

<p>$ gem install bundler</p>

<p>$ bundle</p>

<p>$ rspec spec</p>

<p>├── spec</p>

<p>│   ├── fixtures</p>

<p>│   │   ├── log</p>

<p>│   │   ├── <a href="white_list.html">white_list</a></p>

<p>│   ├── integration</p>

<p>│   │   └── runtime_spec.rb</p>

<p>│   ├── spec_helper.rb</p>

<p>│   ├── strategies</p>

<p>│   │   └── sql</p>

<p>│   │       ├── ragel_spec.rb</p>

<p>│   │       └── regext_spec.rb</p>

<p>│   ├── support</p>

<p>│   │   └── shared_example_strategy_sql.rb</p>

<p>│   └── unit</p>

<p>│       ├── log_entry_spec.rb</p>

<p>│       ├── log_spec.rb</p>

<p>│       ├── sql_info.rb</p>

<p>│       └── white_list_spec.rb</p>

<h2 id="label-Running+MonCSRF">Running MonCSRF</h2>

<p>To run MonCSRF, one needs to give the name of the log file:</p>

<p>$ bin/parser.rb PATH_TO_THE_LOG</p>

<p>To run monCSRF using the default <a href="logs/log.html">logs/log</a> file:</p>

<p>$./run.sh</p>

<p>To test benchmark:</p>

<p>$./benchmark.sh</p>

<h2 id="label-Documentation">Documentation</h2>

<p>The complete documentation of monCSRF in HTML is at:</p>

<p>/doc/README_rdoc.html</p>

<p>This documentation was generated using <a href="http://9">RDoc</a> and can
be updated by:</p>

<p>$ bundle</p>

<p>$ rdoc</p>

<h3 id="label-Developers">Developers</h3>

<p>Marina von Steinkirch, steinkirch at gmail.com</p>

<p>Riccardo Pelizzi, r.pelizzi at gmail.com</p>

<h3 id="label-References">References</h3>
<dl class="rdoc-list label-list"><dt>1
<dd>
<p>CWE/SANS Top 25 Most Dangerous Software Errors, <a
href="http://cwe.mitre.org/top25/index.html.">cwe.mitre.org/top25/index.html.</a></p>
</dd><dt>2
<dd>
<p>Jovanovic, N., Kirda, E., &amp; Kruegel, C.,  Preventing cross site request
forgery attacks, 2007.</p>
</dd><dt>3
<dd>
<p>Barth, A., Jackson, C., &amp;  Mitchell, J.C.,  Robust Defenses for
Cross-Site Request Forgery, CCS  2008.</p>
</dd><dt>4
<dd><ol style="list-style-type: upper-alpha"><li>
<p>Pelizzi &amp; R. Sekar, A Server- and Browser- Transparent CSRF Defense for
Web 2.0., 2011.</p>
</li></ol>
</dd><dt>5
<dd>
<p>Xu, W., Bhatkar, E. &amp; Sekar, R.,  Taint-enhanced policy enforcement,
2006.</p>
</dd><dt>6
<dd><ol style="list-style-type: upper-alpha"><li>
<p>Sekar, An Efficient Black-Box Technique for Defeating Web Application
Attacks, 2008.</p>
</li></ol>
</dd><dt>7
<dd>
<p>RVM Sources, <a href="http://beginrescueend.com/.">beginrescueend.com/.</a></p>
</dd><dt>8
<dd>
<p>Ragel Sources, <a
href="http://www.complang.org/ragel.">www.complang.org/ragel.</a></p>
</dd><dt>9
<dd>
<p>RDoc Sources, <a
href="http://rdoc.sourceforge.net/.">rdoc.sourceforge.net/.</a></p>
</dd></dl>

</div>



<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

